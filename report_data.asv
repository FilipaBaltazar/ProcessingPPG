valuesFiltered = [0.0014898269342038222, -0.172414213994714, -0.4808194609670374, -0.729636843836397, -0.7023529081314859, -0.4376180609678292, -0.36864968258491987, -0.9921588341460057, -2.2214163386390045, -3.1634701177544757, -2.884776358968184, -1.6393805884423678, -1.1331813438042908, -3.0171326844391952, -6.762046587649646, -9.35028662065618, -7.9329816237826, -3.414236439148392, -1.0310549032809484, -6.026599639522699, -17.32953595253746, -25.207222029850538, -16.481495947552492, 15.611620708528399, 64.71402823939539, 113.89581397033994, 146.19665847305367, 155.18860894173204, 147.57215754841906, 136.5036106897615, 131.73540242298589, 134.37370155323967, 139.19782906214476, 140.97139799034866, 138.77484739184678, 135.43290007716942, 133.93366287317025, 134.77959426276428, 136.31336659136764, ...
136.85647504515717, 136.20395668368883, 135.317881183061, 135.05561235965902, 135.4029584393364, 135.75417805746685, 135.63953695483528, 135.09786570013281, 134.5011588549303, 134.18521624435118, 134.23817379537303, 134.42260996075, 134.62960152161122, 134.77783710855107, 134.85719188501392, 134.91211407533018, 134.9920662055366, 135.11247790322506, 135.25207305884018, 135.38032184004186, 135.48752303935962, 135.59304557568032, 135.72605567759905, 135.89557873444116, 136.07605078955532, 136.2235613104527, 136.31350160296932, 136.36745341127903, 136.43832713112684, 136.55749997297397, 136.6850881716955, 136.71385048039286, 136.53792176941658, 136.140373481887, 135.62779598581514, 135.17787373749516, 134.93356602972932, 134.92257301016596, 135.05927895287934, 135.21940989742333, 135.32276591355742,...
135.3627806302715, 135.37491325196532, 135.387144004376, 135.40077680901746, 135.40991668323687, 135.42752139945327, 135.4829369906404, 135.59042917256923, 135.7228835555737, 135.8239861704534, 135.8541644365415, 135.8282304582187, 135.80445557646905, 135.82680281562776, 135.86801112937275, 135.82771160545954, 135.59718573319722, 135.14492421624377, 134.55621144722733, 133.99213512064188, 133.59730675572712, 133.4231471849117, 133.41810391846408, 133.48392514718904, 133.5468919720088, 133.59075944445615, 133.63627102735873, 133.69763146560805, 133.75896024149537, 133.79053158075703, 133.78575604322762, 133.7797403578525, 133.82710634383267, 133.95458245902884, 134.13141783040425, 134.29012291401096, 134.3863448817301, 134.44505665683425, 134.54205171503125, 134.72398843570653,...
134.93117888004758, 134.9996718373312, 134.76139358880792, 134.17449363207817, 133.3803429164258, 132.63465464853766, 132.1596263487145, 132.0256486565084, 132.14365059737625, 132.3561126378865, 132.54365505920993, 132.6691722833812, 132.7499721805805, 132.80872480385753, 132.85504762055405, 132.9012757412644, 132.97662792276643, 133.11262598511166, 133.31251969852224, 133.54067455701167, 133.74833851291842, 133.91207957087946, 134.04664807677037, 134.1812267158405, 134.3273712829131, 134.4744271920018, 134.615309273246, 134.76777809939085, 134.95680686489283, 135.16515263865494, 135.30112602830903, 135.2287052372369, 134.85483689313511, 134.2104960395975, 133.45873010606707, 132.81604527546955, 132.43980838809557, 132.3579275958375, 132.48089426309718, 132.67414663303126, 132.83311030006095, ...
132.91734588138561, 132.94085613691192, 132.9425411532815, 132.9620238206108, 133.02689615577148, 133.14853373595443, 133.32073179824147, 133.52345071683635, 133.73188903538096, 133.92672222737943, 134.10052880990065, 134.258315752489, 134.41266834461086, 134.57499221684873, 134.74544223008039, 134.9093241422843, 135.04878856774698, 135.16525800801833, 135.29195981105272, 135.47157768059841, 135.70369824731665, 135.90373608560424, 135.92324938080097, 135.63886531391702, 135.05365720738206, 134.32907222091617, 133.70999958244667, 133.38868721436154, 133.4042494583307, 133.6462904508749, 133.94834048971458, 134.1911175094923, 134.34424336491904, 134.43745776145903, 134.50903446066937, 134.58102489341795, 134.66800375895411, 134.78949107108426, 134.96146553247468, 135.17631229978264, ...
135.3995559950472, 135.59466901554424, 135.75256640856804, 135.8940411102991, 136.04051849892517, 136.18445825796132, 136.29581766269686, 136.36248714663014, 136.42145944335098, 136.53821812557717, 136.74008733656245, 136.95944717021962, 137.0485417765527, 136.87023427584234, 136.40317396076927, 135.77672146490116, 135.20482929761624, 134.8651625205613, 134.81005410586988, 134.96287468011323, 135.18699834305966, 135.36791784475128, 135.45532494288994, 135.4582524765313, 135.41772124903576, 135.38256368846186, 135.39421673756686, 135.4752129038222, 135.620864651414, 135.80266639095623, 135.9843299583854, 136.13891523942274, 136.25440906808439, 136.32992626277064, 136.37586431020452, 136.42128987446554, 136.5115236580974, 136.67776474627868, 136.88915762160778, 137.03037535968912, ...
136.94406316281822, 136.52827443744582, 135.82298719471348, 135.01403629695574, 134.34080932270916, 133.9688915323309, 133.9142737373932, 134.06399217492216, 134.26354307627707, 134.40308301484916, 134.45090145414895, 134.43262045764746, 134.3932856829607, 134.37138017487877, 134.39070017170334, 134.46163317633102, 134.58276725714506, 134.74378482641418, 134.93132165555323, 135.1329461382356, 135.33438758396557, 135.51567993160373, 135.6581012866633, 135.76269450984793, 135.86164420588014, 136.00009784889224, 136.18971942083772, 136.36896551994622, 136.41143992921369, 136.19249926646503, 135.67570968341192, 134.95517372314686, 134.22093713158364, 133.6664643025764, 133.39938184146695, 133.407991011894, 133.5926730396843, 133.8300327325926, 134.0277418020676, 134.14809072100033, 134.1999020839261, ...
134.21693214551584, 134.23829087087736, 134.29475547404735, 134.40178525371516, 134.55745812831853, 134.74450687315888, 134.937201748412, 135.11392806700243, 135.27121225235, 135.4275822903943, 135.60789617358327, 135.8155092267528, 136.01804232524174, 136.16998120776367, 136.2609850812316, 136.3447716178682, 136.50385541958852, 136.76128968331724, 137.01157342950685, 137.04831291247237, 136.69617531717068, 135.95450755554816, 135.03442994394428, 134.2464225307219, 133.81498423896318, 133.75897527392422, 133.92061754119777, 134.1044622531826, 134.2066740486623, 134.2420164236086, 134.27468494077934, 134.33686044847718, 134.40949352508338, 134.46392488343298, 134.5086009650596, 134.58832857541123, 134.7414804078449, 134.9615987940828, 135.20034076574683, 135.40618835791412, 135.56205175914454,...
135.6910485658738, 135.8327014465726, 136.0129137193712, 136.22780722412375, 136.444892902554, 136.6165864332113, 136.7035421547571, 136.7016818719521, 136.66229384587365, 136.6802168332505, 136.83507481189375, 137.11276594248173, 137.3671150649509, 137.37309654612426, 136.96084716966413, 136.14708776262455, 135.16248004450298, 134.33894392033477, 133.92367772123018, 133.9477812988748, 134.2374885606546, 134.54967697111786, 134.72499658471347, 134.7548562674363, 134.7291957100453, 134.73825684289702, 134.80986703845056, 134.91883339786816, 135.03426269201307, 135.1493233160851, 135.2726171109051, 135.40640689770544, 135.5445644555073, 135.68870608263464, 135.85184300750768, 136.0340175127932, 136.19690640548197, 136.28183652508994, 136.27322089068878, 136.24760315145534, 136.337507855509,...
136.60891615723853, 136.95097478116207, 137.0933446389438, 136.77582757497083, 135.9556398160006, 134.88233420704182, 133.96455868543273, 133.5187858174416, 133.5876786458963, 133.95799482603132, 134.34138935192829, 134.5653096193916, 134.6373326760922, 134.66713664518284, 134.74517583807497, 134.88293328403725, 135.0401337804098, 135.1852401381516, 135.32527074465366, 135.4888768175604, 135.69158114712937, 135.91657804882064, 136.12213732175132, 136.266581623365, 136.33662959755205, 136.36583625938516, 136.42409516681698, 136.569298749006, 136.78128142676175, 136.93134250175706, 136.8333560045066, 136.36381884730434, 135.56552092570692, 134.65642387582284, 133.91725997649135, 133.5348867074063, 133.51047436026914, 133.69198468696158, 133.89196171040743, 133.99931281380694, 134.01665328653107, ...
134.01717448226722, 134.0723696970627, 134.20413610176465, 134.38145718948317, 134.55113379423958, 134.67813206917475, 134.77077130937167, 134.87335323548717, 135.02686584819224, 135.22548110675734, 135.4115408909173, 135.52672532726635, 135.58162964938936, 135.6709045568315, 135.89516312003263, 136.23889571826734, 136.5158047059412, 136.45859507482118, 135.9071811506848, 134.95488774817397, 133.92592277439928, 133.18557735374486, 132.92317168197036, 133.06601692922155, 133.37455525013104, 133.626566635135, 133.74401793661173, 133.78392930503992, 133.83771523334082, 133.94140483057032, 134.06644122990613, 134.17508910037358, 134.27021200103223, 134.39199213053692, 134.57260659498434, 134.79862528403956, 135.0174718924905, 135.18053533462893, 135.28314034596264, 135.36610262467497,...
135.47837546818278, 135.63414264308378, 135.80314711078594, 135.94503374693562, 136.0573447344022, 136.18777636219497, 136.38458802878682, 136.61979461682859, 136.75730575486034, 136.61042412402816, 136.06713080363545, 135.1934406641276, 134.22775686102787, 133.457554721748, 133.06136160450896, 133.02618412569853, 133.19118878902097, 133.3721892714192, 133.4704197767482, 133.49379552163754, 133.501445545068, 133.53614181059888, 133.60028541733303, 133.6811850291456, 133.7838806698591, 133.9330517794787, 134.14448695956057, 134.39977277848402, 134.6530840404865, 134.86468664577868, 135.028929207731, 135.1699836436229, 135.31192507255489, 135.45651884138096, 135.59298756052087, 135.7282060738046, 135.89762484579913, 136.13341145788942, 136.40719680857524, 136.60328055133363, 136.56384070461132,...
136.1875111781183, 135.51208107054273, 134.71447744911802, 134.0208590077693, 133.58860600311726, 133.44083644429432, 133.4900612282757, 133.61672035590914, 133.73945317491777, 133.8346215105332, 133.91178962968976, 133.98350954251634, 134.0556285400041, 134.13430080499938, 134.23038189451574, 134.35218978276242, 134.4969296414582, 134.65220068149287, 134.80716355199365, 134.9600550806762, 135.11408242202364, 135.26905342515553, 135.42173947909671, 135.57594201183676, 135.746844911605, 135.94494512314827, 136.14718520506202, 136.27974189584174, 136.24053706528747, 135.95586053109147, 135.43479503948035, 134.78234053885052, 134.15686590771767, 133.69804416240493, 133.46996321692438, 133.44816726029623, 133.55065999575785, 133.687719944534, 133.80006766621477, 133.87078122733695, ...
133.91284180058003, 133.9476576942398, 133.99103596363585, 134.054171254086, 134.15301459985753, 134.30926112912638, 134.53206421626, 134.79242226250986, 135.0224263347989, 135.1575088207374, 135.1982976332309, 135.2337284217488, 135.38268718901955, 135.6808693794989, 136.00338986154875, 136.1058369986264, 135.77657743560545, 134.99543553148226, 133.9745581778337, 133.0432538660759, 132.46030976637635, 132.2878212451137, 132.40357359178392, 132.6200388773951, 132.80431993035364, 132.9222394501503, 133.00748783170948, 133.1068435686279, 133.2486981412589, 133.4396006161915, 133.6692148961742, 133.91299961982662, 134.14201160940254, 134.34295977773286, 134.53078051663817, 134.7342185000679, 134.9621895420846, 135.18828494605754, 135.37797086946426, 135.53530302667596, 135.71216715285206, ... 
135.95022029902216, 136.1975408552351, 136.2865159923255, 136.01969745349462, 135.31704622887327, 134.31070316754932, 133.30085968890734, 132.59275552637794, 132.329060795849, 132.43440254832242, 132.700535786816, 132.93422470737832, 133.05875579096667, 133.11396387814747, 133.18386747358284, 133.32158567304486, 133.52488830669336, 133.75854701406067, 133.98893004139543, 134.2032425998446, 134.41018755393037, 134.63171851053397, 134.88961822109803, 135.1866245776147, 135.49293569089477, 135.7563158618824, 135.94271150381712, 136.07818931419382, 136.24470011502422, 136.51076144220264, 136.83987161710533, 137.0602720600812, 136.94409635652477, 136.36097915443705, 135.39630636274157, 134.33563764307337, 133.5162216031549, 133.14699025304475, 133.21645034775366, 133.5385175163393, 133.8893277387459, ...
134.13082211497647, 134.25040887455606, 134.31777629664919, 134.4108149233454, 134.56536523704327, 134.77077110104426, 134.99829581760923, 135.23202058331236, 135.47668386508744, 135.7387970250047, 136.00246159133397, 136.23034993791097, 136.39822112601618, 136.53374102840618, 136.71043188016966, 136.9779553779866, 137.27825727350523, 137.43143197729162, 137.23399092552688, 136.6122377953543, 135.7109860748891, 134.8349484436356, 134.27376759817363, 134.13817867306648, 134.32699288101247, 134.63093663326782, 134.88342313512138, 135.0399997152124, 135.14946222422424, 135.2703901656983, 135.41554313648373, 135.56132860965226, 135.69279648461836, 135.82943017259927, 136.0060649297658, 136.23159660458103, 136.46996954011468, 136.6663139512185, 136.79740501946387, 136.8998127039066, 137.0406024499399, ...
137.24446911287228, 137.4331304171775, 137.43776283118964, 137.0963456164392, 136.3775969942074, 135.43685549321825, 134.55207108212713, 133.97627547720003, 133.80582332065978, 133.95154951509528, 134.22243928288944, 134.45128638590248, 134.5720409437542, 134.61276586983558, 134.6367712632948, 134.69026109544257, 134.7894089908809, 134.9363630362536, 135.1331814605936, 135.3768796771206, 135.64487804460495, 135.89317315516755, 136.07909629271987, 136.1962705323915, 136.29169397901072, 136.43890933300068, 136.67135313818076, 136.91906560547704, 137.0064527885052, 136.736569535896, 136.02094023512603, 134.9681646300977, 133.85656961438096, 132.9934141501773, 132.55639475798955, 132.51900093955592, 132.7053910921095, 132.92147182735266, 133.06394333708482, 133.1396766812727, 133.208376592663,... 
133.31412402120102, 133.4599890086946, 133.63041051073776, 133.82372533489036, 134.05800352251904, 134.3451769853331, 134.6611959106258, 134.94468074577682, 135.13568583709863, 135.22977605155805, 135.30120360569782, 135.46298649606507, 135.77558337590764, 136.16554615637924, 136.42494559046142, 136.31410679887898, 135.7112721451291, 134.70332285299278, 133.55115700139226, 132.55318251337079, 131.9004164452205, 131.61543197181115, 131.59476000733815, 131.6995337291083, 131.82472004281044, 131.91796908176, 131.96878718765322, 131.99672587395688, 132.0427391720047, 132.15335037365057, 132.35175479326995, 132.61719129092373, 132.8960255510974, 133.1415037201564, 133.3507943010659, 133.56680266811048, 133.84105861967404, 134.18631514067332, 134.55668855808972, 134.87377176703455, ... 
135.08363423834464, 135.2063070538097, 135.33684083483527, 135.58229664556052, 135.9663256704123, 136.36826293006945, 136.55715844948085, 136.3178649045268, 135.59564147505253, 134.55506419925266, 133.5016661039067, 132.71607409330107, 132.31559785866398, 132.2344350749606, 132.31674975982048, 132.43580997312623, 132.54837206175333, 132.66368118401454, 132.78359564938216, 132.88201038579308, 132.93703244031792, 132.97192613578926, 133.05378700360058, 133.24430869024653, 133.5488421844721, 133.91219322122598, 134.2640422394975, 134.56992519506787, 134.84164108496535, 135.10382958759152, 135.3576723334099, 135.58313771909752, 135.77738426625115, 135.98252890967825, 136.25757184443913, 136.60406821863612, 136.9085999071194, 136.96821710845393, 136.60529045898522, 135.7957431530321, 134.71557669543262,...
133.66324261164473, 132.90678622678388, 132.5585548963102, 132.55364037866198, 132.72811544622934, 132.9281981266123, 133.07769995739693, 133.1746188400319, 133.24689191040642, 133.31624509304334, 133.3914682084971, 133.4808667405741, 133.60046896618744, 133.76613661991095, 133.97941847928166, 134.22501658353622, 134.48466752688617, 134.75131379707085, 135.02499490236164, 135.29239992334402, 135.51712255080614, 135.66419565598324, 135.74515466704145, 135.83528149350502, 136.0218832169292, 136.3043140212766, 136.53119547841663, 136.45430809873145, 135.88928401056165, 134.87288545242697, 133.68639891675303, 132.70799422905915, 132.19544428623783, 132.15593282761284, 132.3907173523191, 132.66150176676112, 132.8425912990679, 132.95187311929004, 133.07026726066903, 133.24346421463545, ...
133.45091119237645, 133.64895898398765, 133.82804170022843, 134.02422658037304, 134.2775257294347, 134.58203911871013, 134.87692732369428, 135.0904435052305, 135.20263564530748, 135.27347331747447, 135.40561148783908, 135.65832478688975, 135.97223019161692, 136.1690620254786, 136.0459027825958, 135.51111138673699, 134.66442835773083, 133.7580927647947, 133.06046306279796, 132.71269382781668, 132.676325348109, 132.79760889194233, 132.9271643346257, 133.00238232900787, 133.04465262897506, 133.09956021926135, 133.1849761474463, 133.28943406802946, 133.40854221502278, 133.5715235075928, 133.82293847970035, 134.17150643824752, 134.55566532183587, 134.8682750749981, 135.0357994618802, 135.0896517542091, 135.16086294855862, 135.38059079965916, 135.74971269750893, 136.08382988440252, 136.09888015404158, ...
135.59559467367765, 134.6115694376907, 133.42383981884387, 132.39314400208474, 131.76270298237372, 131.55251533007274, 131.6063388423829, 131.73313615714687, 131.82538192520963, 131.87864583701798, 131.93789374903272, 132.0364895227864, 132.17572877217862, 132.3399686776544, 132.51436468204307, 132.69001207801657, 132.8653679041632, 133.05125823129814, 133.26915001397188, 133.53042398238506, 133.81101088404398, 134.0565855348842, 134.23063682444493, 134.3643104905905, 134.5447513228382, 134.8253165935007, 135.1263205267535, 135.22768842335054, 134.89370494214864, 134.05196111222492, 132.88477236227456, 131.74714507627945, 130.9625559821211, 130.64710700780813, 130.6846842731635, 130.85224370313207, 130.9820853250907, 131.03888418745757, 131.07964621275244, 131.16114962963636, 131.28435821975842, ...
131.41109836638574, 131.51747643321835, 131.62256676203683, 131.7692228311852, 131.98152643999043, 132.24186782498148, 132.50561431465127, 132.73821605978333, 132.94173444435157, 133.14996363975288, 133.39785694570702, 133.690347489053, 133.99465493061422, 134.2638908057085, 134.47214627056536, 134.63585362320308, 134.79962393633753, 134.99000769689945, 135.17467572925463, 135.25684781563297, 135.11772997691008, 134.68349014795015, 133.97387250151996, 133.1022013815302, 132.22953409758395, 131.5026888264568, 131.0093910488707, 130.7656436206696, 130.72965551300265, 130.82800617044614, 130.98395255491403, 131.14078591884834, 131.27555007622806, 131.39951397047284, 131.54458160950054, 131.74387650273826, 132.01468440965115, 132.35096530231877, 132.72600652896867, 133.10280845457703, ...
133.4496047943315, 133.75465259630022, 134.0294462576896, 134.29304591982378, 134.5466201317106, 134.76380599165583, 134.91640880079936, 135.01964012101746, 135.14929948164615, 135.3934141208871, 135.75789856329544, 136.1031075750896, 136.1858563436534, 135.80589502722472, 134.96106865627237, 133.8875610909172, 132.94069423653593, 132.3928966104036, 132.2908795940946, 132.4687986318541, 132.69265993074774, 132.8177855648678, 132.84913298831026, 132.88297558730181, 133.00131939376143, 133.20851103370705, 133.44750011846162, 133.66239931263434, 133.84643043446826, 134.04122607952365, 134.29785205030848, 134.633446483834, 135.01134620867867, 135.35486525524178, 135.5885737807523, 135.68848535402387, 135.71100509575746, 135.77117196624692, 135.9670688556644, 136.29164421672098, 136.59805425770378,...
136.66247610479294, 136.32024004895047, 135.58645858131655, 134.67249708850665, 133.87709643766476, 133.42486717217744, 133.3549288529901, 133.5342345013069, 133.76833245918957, 133.92347352486496, 133.98016850674074, 133.9993373428364, 134.04779346734588, 134.14866101953442, 134.2859315288612, 134.44103920504753, 134.61673605303483, 134.82437290239395, 135.05414047136466, 135.2658546595148, 135.41961229118738, 135.5222046580029, 135.64008757688143, 135.84831156689938, 136.14617593764436, 136.41031694601585, 136.4405421657991, 136.08343361826664, 135.3479786338562, 134.42336709294318, 133.57876306242943, 133.01474500358276, 132.773085042012, 132.75835098250764, 132.8372342108194, 132.92822840211812, 133.02050466759064, 133.12918340676381, 133.24964206856694, 133.3567906496176,...
133.44182522208175, 133.5392349289819, 133.7067658057483, 133.97093687223986, 134.28970361142296, 134.57353694308574, 134.7550804324713, 134.8498190515296, 134.9507504229861, 135.15351334166724, 135.47170065857907, 135.8186231239008, 136.07905452894138, 136.2133132166686, 136.2977642155491, 136.44952085145954, 136.69621062147544, 136.90093754042923, 136.8258684643483, 136.3010784608849, 135.36882064999156, 134.2862514550681, 133.37999903247265, 132.86064559971257, 132.7299965485048, 132.83222760537913, 132.98657636023626, 133.0937494848922, 133.15295116090033, 133.20889299734463, 133.29420854695624, 133.41288317485905, 133.5553397647502, 133.71779009400987, 133.90322360503143, 134.11202813471053, 134.33844020708338, 134.5764882384462, 134.82647486608124, 135.09217565146105, 135.37086437938856,...
135.64533276373052, 135.88546227658887, 136.06157670933518, 136.1654420816742, 136.22694004493567, 136.30547347133992, 136.4504480490782, 136.64277878163188, 136.7621808823151, 136.62415620508798, 136.08499766021964, 135.15387867998453, 134.02654604134378, 133.00023620210482, 132.3168072941216, 132.0406815733031, 132.05572137435578, 132.17515235606655, 132.27382491123436, 132.34425524877778, 132.4500212791034, 132.6355996760129, 132.8775087779603, 133.11306841968047, 133.30698079786913, 133.48689706333053, 133.71498378229865, 134.0240478858326, 134.37885853078592, 134.6982591908106, 134.91646720618073, 135.0319196615834, 135.10565608827807, 135.21556246103128, 135.40463504074967, 135.66055707244922, 135.9342025752828, 136.17366642514534, 136.34619287891306, 136.43593758363622, 136.42623002676123,...
136.2884929989616, 135.9888872970248, 135.5129454254664, 134.89314808514428, 134.22070900002134, 133.62504944557207, 133.22491715920307, 133.07499417356453, 133.13890690722386, 133.31088579215913, 133.4765494982579, 133.57360539193783, 133.6138750000941, 133.65467239241508, 133.74751737411046, 133.90358280202545, 134.09906836330833, 134.30703130009692];

peaksIndices = [121, 150, 183, 240, 269, 301, 336, 366, 393, 421, 453, 484, 513, 541, 569, 598, 625, 651, 677, 704, 736, 767, 797, 824, 851, 879, 912, 945, 974, 1000, 1031, 1063, 1094];
peaksIndices_new=[70, 94, 121, 150, 183, 213, 240, 269, 301, 336, 366, 393, 421, 453, 484, 513, 541, 569, 598, 625, 651, 677, 704, 736, 767, 797, 824, 851, 879, 912, 945, 974, 1000, 1031, 1063, 1094];
threshol = 2.464082215599494;
figure;
plot(valuesFiltered);
xlim([100 650]);
ylim([125 140]);
ylabel("Luma channel value");
xlabel("Sample index");
hold on;
stem(peaksIndices+1,valuesFiltered(peaksIndices+1), "HandleVisibility","off");
stem(peaksIndices_new+1,valuesFiltered(peaksIndices_new+1));
legend({'Filtered Arrays','Validated Peaks'},"Location","southoutside","Orientation","horizontal");


%%
valuesMean= [0.1029947396573658, 0.2328892829034706, 0.40579548934797793, 0.6435016543414238, 0.9730716351762073, 1.4261695913990435, 2.038128236099908, 2.846790444905485, 3.8911649740906293, 5.209946386943291, 6.839956629655526, 8.81457067059816, 11.162190958329182, 13.90483501816539, 17.056897272261427, 20.624140237403147, 24.602961853996028, 28.979975168034816, 33.731924362863154, 38.82594890620909, 44.220188032019344, 49.86471443254745, 55.70276230002752, 61.67220770415966, 67.70724784730734, 73.74021746646322, 79.70347493304716, 85.53128851258963, 91.16164937647338, 96.53794840509055, 101.61045231510954, 106.33752649860266, 110.68656176962998, 114.63457443370446, 118.16846250251602, 121.28491488493063, 123.9899843868207, 126.29834874211491, 128.23229610232536, 129.82048191546107, ...
    131.09651249127583, 132.09741644076757, 132.86206836964695, 133.42962959650274, 133.83806828087367, 134.12281633219362, 134.3156292390225, 134.4436290606091, 134.52864700994732, 134.58682725533336, 134.54213100764485, 134.49760398681346, 134.45329192465456, 134.40922709286534, 134.36545129173123, 134.32201733666744, 134.27899020729487, 134.23644778420913, 134.1944811132364, 134.1531941546666, 134.11270299499017, 134.07313452022402, 134.03462457208653, 133.99731563011233, 133.961354083355, 133.92688717368873, 133.89405970807644, 133.86301064882542, 133.8338696982488, 133.80675301591717, 133.7817622454115, 133.7589806744615, 133.73847099808992, 133.72027359681326, 133.70440539341953, 133.69086254013877, 133.679614958724, 133.67060928023196, 133.6637718636669, 133.65901010984234, ...
133.65621506340054,133.65526438480978, 133.6560339977659, 133.65838683851925, 133.66218378803666, 133.66728744292257, 133.67356564682495, 133.6808946584026, 133.68916184810556, 133.69826783644604, 133.7081280101883, 133.7186733789588, 133.72985076202423, 133.74162232224444, 133.75396449033127, 133.76686634641024, 133.7803140033861, 133.79431714126991, 133.80889102138556, 133.82405443756122, 133.8398275510649, 133.85622970735426, 133.8732560810055, 133.89092118059435, 133.90923311808328, 133.92819338308985, 133.9477967923639, 133.9680316165149, 133.98888695933726, 134.0103409114395, 134.03236749390817, 134.0549377799566, 134.0780210869752, 134.1015909721476, 134.12561810798496, 134.1500756749592, 134.1749406199366, 134.20019473817206, 134.2258255337449, 134.25182682234993, 134.2781990509351,...
134.30494932038496, 134.3320911097414, 134.3596437128391, 134.3876314101585, 134.41607971817663, 134.44501989751893, 134.47448452333848, 134.5045061648564, 134.5351160186592, 134.56634255153583, 134.59821020826425, 134.63073118014495, 134.66391948513498, 134.6977821784429, 134.73231916386558, 134.76752319850416, 134.8033800906474, 134.83985459477412, 134.87691615542164, 134.91452664661668, 134.95264040520036, 134.99120441598285, 135.03015865424356, 135.0694070487057, 135.10886948949596, 135.14845619533338, 135.1880670228667, 135.22759100840634, 135.26690619975327, 135.3058798271482, 135.34436885092222, 135.38222090962472, 135.41927567679883, 135.455366617801, 135.49032312084356, 135.5239729595325, 135.55614502832893, 135.58666634066736, 135.61537777712724, 135.64213044122596, 135.6667889772725, ...
135.6892346587859, 135.70936413163662, 135.72710031037664, 135.74238180597862, 135.7551780069618, 135.76548284537824, 135.7733144609544, 135.77871420270168, 135.78174501032095, 135.7824892408598, 135.78105118826056, 135.77754510082946, 135.77209654073877, 135.76483927921242, 135.75591216735043, 135.7454560909546, 135.73361111090605, 135.72051387982071, 135.70629541142665, 135.69107926202244, 135.67498016429676, 135.65810313357613, 135.64054304612148, 135.62238466932052, 135.6037031053618, 135.58456459400966, 135.56503975848705, 135.5451789318174, 135.5250273495425, 135.50462598989935, 135.48401249378747, 135.4632221075091, 135.44232901714108, 135.42136699690255, 135.40037215392996, 135.37938301101568, 135.35844057728292, 135.33758839125093, 135.31688376214473, 135.29637816576684, 135.27612717188032,...
135.25619084375478, 135.2366339983833, 135.21752629178104, 135.19894210003386, 135.18096017472507, 135.16366306070606, 135.1471362744805, 135.13146725230456, 135.11674408797242, 135.10305409065035, 135.0904822025778, 135.07910932448695, 135.06901718088994, 135.06027256178365, 135.0529331542112, 135.0470457178479, 135.0426445181197, 135.03975007791402, 135.03836829726356, 135.03848564747045, 135.0400783750799, 135.04310797791067, 135.04752222722954, 135.05325250607208, 135.06022248356675, 135.0683464115086, 135.0775309760462, 135.0876772619448, 135.09868276515405, 135.11044096362642, 135.12284745412643, 135.13579956643582, 135.14919783132152, 135.16294723333388, 135.1769582239858, 135.1911474813482, 135.20543841271603, 135.21976140727645, 135.2340538552243, 135.24825995812998, ...
135.26233036224582, 135.27620852560776, 135.2898581776721, 135.30324779896952, 135.31635063742777, 135.3291446205637, 135.34161217626553, 135.35373054856456, 135.3654916418193, 135.3768909909761, 135.38792787811943, 135.398605349126, 135.40893012986163, 135.41891244502492, 135.4285657462896, 135.43790635965675, 135.4469530647901, 135.45572662143977, 135.4642422000873, 135.47252112717166, 135.48058403866932, 135.48844998034647, 135.49613556969132, 135.50364729373, 135.51099299088156, 135.51817515599055, 135.52519026061347, 135.53202828341674, 135.5386724747004, 135.54509937032634, 135.5512790608467, 135.55717571179224, 135.56274832128562, 135.56795507244283, 135.57274725895005, 135.57707440863274, 135.5808854995713, 135.58413025809872, 135.58676049319092, 135.58873345422748, 135.59000874475905,...
135.59055178421283, 135.59033471116152, 135.5893371214174, 135.58754661408014, 135.58495912556165, 135.58157903932795, 135.5774190673268, 135.57250116915705, 135.56685380472612, 135.5605123184481, 135.5535180998283, 135.54591760802614, 135.5377663068654, 135.5291188078379, 135.5200321870976, 135.5105651048147, 135.50077695446907, 135.4907270631038, 135.4804739602833, 135.470074729696, 135.4595844532249, 135.44905575304517, 135.43853843311814, 135.42807921749812, 135.41772157933127, 135.40750565143384, 135.3974682070136, 135.3876486183148, 135.37807627745983, 135.3687774073576, 135.35977487228485, 135.35108804860468, 135.34273859192626, 135.33473794484726, 135.32709063126305, 135.3197998719285, 135.31286446783088, 135.30627860734742, 135.30003179316518, 135.2941088942841, 135.28849032404253,...
135.28314419541883, 135.27804089649544, 135.27314631822784, 135.26842200986337, 135.2638254341753, 135.25931032312138, 135.25482713155017, 135.25032358350185, 135.24574530259872, 135.24103651509827, 135.23614081150248, 135.23100195028914, 135.22556468544983, 135.21977559816585, 135.21358391220022, 135.2069422724705, 135.19980640865904, 135.19213804402648, 135.1839042516122, 135.1750779574156, 135.165638315048, 135.1555752331671, 135.14488368810038, 135.13356651647098, 135.12163491329994, 135.10910872338275, 135.09601650836476, 135.08240481803094, 135.0683213783122, 135.05382290576432, 135.03897478028438, 135.02385048876738, 135.00853084402695, 134.99310299090357, 134.97765921889135, 134.96229560755168, 134.94711053716279, 134.93220310224038, 134.91767146953384, 134.90361122469105,... 
134.89011375287637, 134.8772646981469, 134.86514254436534, 134.85382017035076, 134.84335777077075, 134.8338052002172, 134.82520122766147, 134.81757307526289, 134.810936251133, 134.80529467563935, 134.80064792215987, 134.796977283127, 134.79425440901045, 134.79243730241532, 134.79147954006027, 134.7913271757956, 134.79191977860972, 134.79319158953678, 134.7950727612209, 134.79749064213178, 134.8003749581949, 134.80365230785284, 134.807250838542, 134.8111015584374, 134.81513950978518, 134.81930477245865, 134.82354327310244, 134.82780738272413, 134.83205629353645, 134.83625617393895, 134.84038010841948, 134.8444007118342, 134.84830492280759, 134.85208534601594, 134.85573991467038, 134.85927139657983, 134.86268676771465, 134.86598856563273, 134.86919101204765, 134.87231021112675, 134.87536372213822,...
134.87837008352184, 134.88134830590397, 134.88431735280057, 134.88729328011905, 134.89029283153099, 134.89333089364007, 134.89641998241032, 134.89956981128765, 134.90278695757527, 134.90607463977, 134.90942763132637, 134.91284094287295, 134.9163055038251, 134.91980814453478, 134.9233317029734, 134.9268552546638, 134.93035446028972, 134.9338020212993, 134.93716823005568, 134.9404215978119, 134.94352954111577, 134.94645910529698, 134.9491816854929, 134.9516652397296, 134.95387949540952, 134.95579638397442, 134.95739044232133, 134.95863917102665, 134.959523340343, 134.96002397277636, 134.96012950061365, 134.9598321814306, 134.95913018383354, 134.9580244288024, 134.95652026410917, 134.9546274536409, 134.95236005448612, 134.94973618461492, 134.9467776877876, 134.94350970588476, 134.9399431445264,...
134.93610370498806, 134.9320160293692, 134.9277021204348, 134.9231798218362, 134.9184614240359, 134.91355245743117, 134.90845072767368, 134.9031456392437, 134.8976178423206, 134.89183922534536, 134.88577326191236, 134.87937570635063, 134.87259758742778, 134.8653823174065, 134.8576694903956, 134.84939654078806, 134.84050054979227, 134.8309201333357, 134.82059734070705, 134.80948847670956, 134.79754851897488, 134.7847416600148, 134.77104260865664, 134.7564376124967, 134.7409251598453, 134.7245338249567, 134.70729183993285, 134.68924236543015, 134.67044370980713, 134.65096914502678, 134.63090630953462, 134.61035620247168, 134.58943178782812, 134.5682562409312, 134.5469608824631, 134.5256828564979, 134.504562618405, 134.483741305491, 134.46335806768207, 134.44354743718773, 134.42443681488095, ...
134.40614257319172, 134.38877135583888, 134.37241654641576, 134.3571569645129, 134.34305594356505, 134.33016080832908, 134.31851043234994, 134.30812217046582, 134.29901365975456, 134.2911736978085, 134.28458008436468, 134.27920073362802, 134.27500518124126, 134.27194850789036, 134.26998210698068, 134.2690559968816, 134.26912108842748, 134.27013131329824, 134.27204552512478, 134.27482909518073, 134.27845513790544, 134.2829053176602, 134.28817020634256, 134.29424918096473, 134.3011498701898, 134.3088871782338, 134.31748193262868, 134.32695921832502, 134.33734244361324, 134.3486599011524, 134.3609380894739, 134.37419984269903, 134.38846254579477, 134.4037365141341, 134.42000893718418, 134.43726925389066, 134.45550033823213, 134.47467452297386, 134.49475400042812, 134.51569147286963,...
134.53743103315043, 134.55991247609515, 134.58306693986393, 134.60682117744335, 134.63109920402746, 134.65582397313466, 134.68091902685262, 134.7063100673065, 134.73192640015884, 134.75770220651708, 134.78357760678185, 134.80949948842823, 134.83542207910557, 134.8613072563674, 134.88712459541026, 134.91285116596896, 134.93846466102167, 134.96395652601393, 134.98932387021412, 135.0145688796536, 135.03969808538025, 135.0647215214784, 135.08963817953352, 135.11446215962573, 135.13920751603428, 135.1638875318827, 135.18851401212765, 135.21309662484177, 135.2376235383098, 135.26209359106468, 135.2864991265345, 135.31082474060563, 135.33504625291704, 135.3591299566401, 135.38303219183837, 135.4066992757009, 135.43006780946857, 135.45306536727392, 135.47561155698799, 135.4976194281491, 135.51899718777725,...
135.5396501719569, 135.55948301006995, 135.5784019099437, 135.59631698635562, 135.6131486689095, 135.62882107475482, 135.64326864827598, 135.65643127249854, 135.66826658728584, 135.67874516075608, 135.68784796115034, 135.6955719743175, 135.70192663186378, 135.70691990022868, 135.7105803100623, 135.71294387223554, 135.71405189889097, 135.71394872397218, 135.7126794211472, 135.7102876167488, 135.70681349080988, 135.70229205066053, 135.69675174925416, 135.69021350496607, 135.68269016171254, 135.67418640870656, 135.66469915883226, 135.6542183644197, 135.64272823000434, 135.6302087643324, 135.61663759917136, 135.60199628837563, 135.58626321228098, 135.56941865263434, 135.5514498190142, 135.53235078306056, 135.51212376850725, 135.4907959140975, 135.46838628061496, 135.44492400581433, ...
135.42045297960996, 135.3950210694535, 135.36868380380017, 135.3415032511501, 135.3135467944564, 135.28488584029125, 135.2555945029936, 135.22574830330754, 135.19542291884193, 135.16469302016586, 135.13363122167286, 135.10230717074458, 135.07078679246334, 135.03913170046135, 135.00739877773051, 134.9756399246439, 134.94390196532817, 134.91223205491988, 134.88066640107672, 134.84923660500857, 134.8179794733546, 134.78692025999175, 134.7560816456555, 134.725495704909, 134.695181050807, 134.66515623925454, 134.63543994170146, 134.60605110544768, 134.57702944191615, 134.54840013026666, 134.52019207255992, 134.4924389893028, 134.46518036455956, 134.43846218257366, 134.41233740510089, 134.3868661484009, 134.36211553070564, 134.33815917446447, 134.31507636220758, 134.29295085982352, 134.27186943577425,...
134.25192011860796, 134.2331902474534, 134.21576595526022, 134.19972664041512, 134.18514459594056, 134.17208285954123, 134.16059324305135, 134.1507146164023, 134.14247151239823, 134.13586844421957, 134.1308992721254, 134.12754522841962, 134.12576943222857, 134.12552092337262, 134.12673615156467, 134.12934077086507, 134.13325167342487, 134.13837918839428, 134.14462544400763, 134.1518934768422, 134.16008593564518, 134.1691069295717, 134.17886367399532, 134.18926788698556, 134.20023690121923, 134.21169446892603, 134.22357125087692, 134.2358049938235, 134.24834041359088, 134.26112064366433, 134.2741040936289, 134.28725441562867, 134.30054002414758, 134.31393346682688, 134.3274106891715, 134.34095023870137, 134.35453245463006, 134.36812161582003, 134.38170173492233, 134.39525663516451,...
134.40877039233223, 134.42222777016434, 134.4356040737226, 134.4488838814539, 134.4620519178559, 134.47509273118737, 134.48799034000885, 134.50072787063837, 134.5132872089401, 134.52563975233187, 134.53776169821552, 134.54962587619147, 134.56120118506092, 134.57245217627755, 134.58333881607956, 134.5938164515746, 134.60383599774562, 134.6133443530561, 134.62228504145494, 134.63059906854798, 134.6382259699701, 134.6451021159458, 134.65116825499368, 134.65636763552928, 134.660647597517, 134.6639611118602, 134.6662682102263, 134.66753725155465, 134.66774926720637, 134.6668917299672, 134.66496279867033, 134.66197136177897, 134.65793723947866, 134.6528899143498, 134.64686816345812, 134.63991909689543, 134.63209700439424, 134.6234620505182, 134.6140788637577, 134.6040274119483, 134.59338006531132,...
134.58221120765225, 134.57059656654747, 134.55861262301386, 134.54633610301988, 134.53384354803512, 134.52121095715478, 134.50851348941063, 134.4958252118799, 134.48321887727772, 134.47076571394277, 134.45853521152213, 134.4466037431116, 134.43503536322126, 134.42389152287717, 134.41323024391545, 134.4031053303707, 134.39356563556356, 134.38465440294306, 134.37642029658423, 134.36889377717105, 134.36209891322537, 134.35605299209257, 134.3507663212832, 134.3462422244831, 134.3424772290455, 134.33943771929174, 134.3371016969919, 134.3354382285983, 134.33440692126248, 134.33395757049908, 134.33403000822534, 134.33455417492067, 134.33545043342383, 134.33663013459906, 134.33799643700632, 134.33944537409556, 134.3408671536397, 134.34214766546086, 134.34317016535385, 134.34381709579574, 134.34397199788873, ...
134.3435210966791, 134.34235602770872, 134.34037529472533, 134.33748604233665, 134.33359483324566, 134.32862783382862, 134.32252224190287, 134.31521615321174, 134.3066706403607, 134.29685771756462, 134.28576446844488, 134.27338555799068, 134.25972634407393, 134.24480227166123, 134.2286380451397, 134.2112666166878, 134.19272803427586, 134.17306819658174, 134.1523375637321, 134.13058987230835, 134.1078809005505, 134.08426732531382, 134.05980570632613, 134.03455162595364, 134.00855900439396, 133.98187960135058, 133.95456270624695, 133.92665156910792, 133.8981907978836, 133.8692226485634, 133.83978751095222, 133.80992444783465, 133.77968388945752, 133.74910705287678, 133.71825716540164, 133.68717798148322, 133.6559171740756, 133.62452594369447, 133.59307170366375, 133.56161472093288,...
133.53021930709525, 133.4989539256915, 133.46789120842655, 133.43710785429766, 133.40668438904115, 133.37670476713097, 133.34725580463208, 133.3184264382637, 133.2903068137783, 133.26298721484952, 133.23655685172216, 133.21110253652893, 133.18670727904325, 133.16344884236912, 133.14140737702206, 133.1206446266108, 133.10121290448657, 133.08315346002058, 133.0664951170971, 133.05125323746677, 133.03742558473718, 133.0249994544979, 133.01394787907248, 133.0042303396263, 132.9957938284029, 132.988584569776, 132.98253166799165, 132.97755820769225, 132.97358380315552, 132.97052717704892, 132.96830867088875, 132.9668525927885, 132.96608931537233, 132.96595704760236, 132.96642209551007, 132.9674469937518, 132.96900788844206, 132.9710955961736, 132.97371613102914, 132.9768906791135, ...
132.98065502065762, 132.9850584202679, 132.99015184250072, 132.99600769128844, 133.00270589210282, 133.01033176916766, 133.01897365031297, 133.0287202848393, 133.03964714681433, 133.05183732630138, 133.0653664836332, 133.08030105578234, 133.096696636141, 133.11459658422982, 133.13403091447836, 133.1550155038591, 133.17755164716866, 133.20162597658253, 133.22720630326657, 133.2542499929646, 133.28270096996988, 133.3124907580093, 133.34353979712043, 133.37575899542188, 133.40904564282107, 133.44329540742444, 133.47839906822202, 133.5142441555981, 133.5507165726822, 133.58770215811546, 133.625088154733, 133.66276455364954, 133.7006252890358, 133.73856926523655, 133.7765012045215, 133.81432363244326, 133.8519559137087, 133.88932473567473, 133.92636471190636, 133.96301875657966, 133.9992382355131, ....
134.03498290686792, 134.07022067094596, 134.10492715384115, 134.13906932177392, 134.17263867445115, 134.20563259577014, 134.2380449502853, 134.2698824695237, 134.30115602915257, 134.33187973727817, 134.36206992678294, 134.39174409576825, 134.42089753527304, 134.4495410860154, 134.47768023549887, 134.50531307675013, 134.53242851627445, 134.55900481913065, 134.58500856676937, 134.61039408752546, 134.63510340106666, 134.65906669743853, 134.68220334947753, 134.704423435231, 134.72562972556779, 134.7457200723207, 134.76459011493662, 134.78213993823618, 134.79826914434295, 134.81288412102876, 134.82590078128004, 134.83724711773797, 134.84687435015132, 134.85474828684946, 134.8608482861765, 134.86517424057797, 134.86774720255787, 134.8686094467663, 134.8678239580629, 134.86548139328323, 134.86168450036664, ...
134.85655322072705, 134.85022262620785, 134.84284049151228, 134.83456457425206, 134.82555968402852, 134.8159946282149, 134.80603912512558, 134.7958607749643, 134.7856221753693, 134.77547826171605, 134.7655739428885, 134.75604209140863, 134.74700193310875, 134.73855786652754, 134.73079872650595, 134.72380543761858, 134.71763415454018, 134.7123257842495, 134.707906443712, 134.7043882923594, 134.7017706911086, 134.70006033847545, 134.6992256165364, 134.69923218514376, 134.70003729385135, 134.70159037811874, 134.7038338178332, 134.70670383783965, 134.7101315261739, 134.71403611566402, 134.71833975995673, 134.72296172736844, 134.72781916693003, 134.73282787356197, 134.73790304501293, 134.74296002455006, 134.74791502458442, 134.7526858273888, 134.75719245976623, 134.76135783892715, 134.7651083869529,...
134.7683671681238, 134.7710703466231, 134.77315926513808, 134.77458129797455, 134.7752905830072, 134.77524861468677, 134.77442468423936, 134.7727894168721, 134.77032929584945, 134.76703897774155, 134.76292143324676, 134.7579878712196, 134.75225744861825, 134.74575442877475, 134.73851158377963, 134.73056725173305, 134.72196423419754, 134.71274860521706, 134.70296847537747, 134.6926727554641, 134.68193003083368, 134.67079256665667, 134.6593132819892, 134.6475460241099, 134.63554594339828, 134.62336993230937, 134.61107708718296, 134.59872914893896, 134.58639087829755, 134.57413032310342, 134.56201893953377, 134.55013764164627, 134.53856348580595, 134.52737610658016, 134.51665669678874, 134.506486833245, 134.49694717665267, 134.4881160810581, 134.4800747182202, 134.47289159757187, ...
134.46662859452314, 134.46133929160422, 134.45706752008485, 134.4538461558636];

peaksIndices=[247, 360, 512, 661, 794, 847, 1006, 1055]-75;
valuesMeanNorm=zscore(valuesMean);
valuesMeanFourier=fft(valuesMeanNorm);
freq=linsppace(0,30,);

figure;
plot(valuesMean);
%xlim([100 650]);
ylim([125 140]);
ylabel("Luma channel value");
xlabel("Sample index");
hold on;
stem(peaksIndices+1,valuesMean(peaksIndices+1));
legend({'Mean Envelope','Validated Peaks'},"Location","southoutside","Orientation","horizontal");

figure;
plot(valuesFiltered);
hold on;
plot((1:length(valuesMean))+75,valuesMean);